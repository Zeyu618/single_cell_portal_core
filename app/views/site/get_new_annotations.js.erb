// dump out annotation dropdown values to see if we have a match for the existing selected annotation
var annotationData = <%= raw @cluster_annotations.values.map {|coll| coll.map(&:last)}.flatten %>;
var selectedAnnotation = $("#<%= @target %>annotation").val();
$("#<%= @target %>annotation").html("<%= escape_javascript(select_tag :annotation, grouped_options_for_select(@cluster_annotations, params[:annotation]), class: 'form-control' )%>");
// also reload subsampling options as they may have changed
$("#<%= @target %>subsample").html("<%= escape_javascript(select_tag :subsample, options_for_select(subsampling_options(@cluster.points), params[:subsample]), {include_blank: 'All Cells', class: 'form-control'}) %>");

if (annotationData.indexOf(selectedAnnotation) >= 0) {
    $("#<%= @target %>annotation").val(selectedAnnotation);
}